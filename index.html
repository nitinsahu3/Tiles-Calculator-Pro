<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Material Area Cost Estimator</title>

<style>
body{
    font-family:Segoe UI, Arial;
    background:#f4f6f9;
    padding:20px;
}
.container{
    max-width:900px;
    margin:auto;
}
.card{
    background:#fff;
    padding:20px;
    border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.08);
    margin-bottom:20px;
}
h2{
    margin-bottom:15px;
    color:#2c3e50;
}
input,select,button{
    width:100%;
    padding:10px;
    margin:8px 0;
    font-size:15px;
    border-radius:6px;
    border:1px solid #ddd;
}
button{
    background:#2c3e50;
    color:#fff;
    border:none;
    font-weight:600;
}
button:hover{
    background:#1a252f;
}
.result{
    margin-top:12px;
    font-weight:600;
    font-size:14px;
}
.history-item{
    background:#eef1f5;
    padding:12px;
    border-radius:8px;
    margin-bottom:8px;
    display:flex;
    justify-content:space-between;
}
.history-content{
    max-width:90%;
}
.delete-btn{
    background:#e74c3c;
    color:#fff;
    border:none;
    border-radius:50%;
    width:22px;
    height:22px;
    font-size:12px;
    cursor:pointer;
}
.small-btn{
    background:#7f8c8d;
}
</style>
</head>

<body>

<div class="container">

<!-- RATE SECTION -->
<div class="card">
<h2>Material Rate Calculation</h2>

<label>Material Name (Optional)</label>
<input type="text" id="materialName">

<label>Material Dimension Unit</label>
<select id="unitSelect">
<option value="ft">Feet</option>
<option value="in">Inches</option>
<option value="cm">Centimeters</option>
<option value="mm">Millimeters</option>
</select>

<label>Unit Length</label>
<input type="number" id="length">

<label>Unit Width</label>
<input type="number" id="width">

<label>Pricing Type</label>
<select id="pricingType">
<option value="piece">Rate per Unit</option>
<option value="box">Rate per Box</option>
<option value="sqft">Rate per Square Foot</option>
</select>

<label>Rate (Rs.)</label>
<input type="number" id="rate">

<div id="boxField" style="display:none;">
<label>Units per Box</label>
<input type="number" id="unitsPerBox">
</div>

<button onclick="calculateRate()">Calculate Unit Rate</button>
<div class="result" id="rateOutput"></div>
</div>

<!-- MANUAL SECTION -->
<div class="card">
<h2>Manual Calculation</h2>

<label>Total Area (sq ft)</label>
<input type="number" id="manualArea">

<label>OR Total Units</label>
<input type="number" id="manualUnits">

<label>OR Total Boxes</label>
<input type="number" id="manualBoxes">

<button onclick="calculateManual()">Calculate</button>
<div class="result" id="manualOutput"></div>
</div>

<!-- LAYOUT SECTION -->
<div class="card">
<h2>Layout Analysis</h2>

<label>Room Dimension Unit</label>
<select id="layoutUnitSelect">
<option value="ft">Feet</option>
<option value="in">Inches</option>
<option value="cm">Centimeters</option>
<option value="mm">Millimeters</option>
</select>

<label>Room Length</label>
<input type="number" id="roomLength">

<label>Room Width</label>
<input type="number" id="roomWidth">

<button onclick="calculateLayout()">Analyze Layout</button>
<div class="result" id="layoutOutput"></div>
</div>

<!-- HISTORY -->
<div class="card">
<h2>History</h2>
<div id="history"></div>
<button class="small-btn" onclick="clearHistory()">Clear All</button>
</div>

</div>

<script>

let costPerSqFt=0;
let areaPerUnit=0;

document.getElementById("pricingType").addEventListener("change",function(){
    document.getElementById("boxField").style.display=
        this.value==="box"?"block":"none";
});

function convertToFeet(value, unit){
    if(!value) return 0;
    if(unit==="ft") return value;
    if(unit==="in") return value/12;
    if(unit==="cm") return value/30.48;
    if(unit==="mm") return value/304.8;
}

function calculateRate(){

    let unit=document.getElementById("unitSelect").value;
    let lengthRaw=document.getElementById("length").value;
    let widthRaw=document.getElementById("width").value;

    let length=convertToFeet(parseFloat(lengthRaw),unit);
    let width=convertToFeet(parseFloat(widthRaw),unit);

    let rate=parseFloat(document.getElementById("rate").value);
    let type=document.getElementById("pricingType").value;
    let unitsPerBox=parseFloat(document.getElementById("unitsPerBox").value)||0;

    if(!length||!width||!rate){
        alert("Fill required fields");
        return;
    }

    areaPerUnit=length*width;

    let ratePerUnit=0;

    if(type==="piece"){
        ratePerUnit=rate;
        costPerSqFt=rate/areaPerUnit;
    }

    if(type==="box"){
        if(!unitsPerBox){
            alert("Enter units per box");
            return;
        }
        ratePerUnit=rate/unitsPerBox;
        costPerSqFt=ratePerUnit/areaPerUnit;
    }

    if(type==="sqft"){
        costPerSqFt=rate;
        ratePerUnit=rate*areaPerUnit;
    }

    let html=
        `Unit Size: ${lengthRaw} × ${widthRaw} ${unit}<br>
         Unit Area: ${areaPerUnit.toFixed(3)} sq ft<br>
         Cost per sq ft: Rs. ${costPerSqFt.toFixed(2)}<br>
         Cost per unit: Rs. ${ratePerUnit.toFixed(2)}`;

    document.getElementById("rateOutput").innerHTML=html;
    saveHistory(html);
}

function calculateManual(){

    if(!areaPerUnit || !costPerSqFt){
        alert("Calculate unit rate first");
        return;
    }

    let area=parseFloat(document.getElementById("manualArea").value);
    let units=parseFloat(document.getElementById("manualUnits").value);
    let boxes=parseFloat(document.getElementById("manualBoxes").value);
    let unitsPerBox=parseFloat(document.getElementById("unitsPerBox").value)||0;

    if(!area && !units && !boxes){
        alert("Enter Area, Units, or Boxes");
        return;
    }

    if(boxes){
        if(!unitsPerBox){
            alert("Enter Units per Box in Rate section");
            return;
        }
        units = boxes * unitsPerBox;
        area = units * areaPerUnit;
    }

    if(units && !area){
        area = units * areaPerUnit;
        if(unitsPerBox){
            boxes = Math.ceil(units / unitsPerBox);
        }
    }

    if(area && !units){
        units = Math.ceil(area / areaPerUnit);
        if(unitsPerBox){
            boxes = Math.ceil(units / unitsPerBox);
        }
    }

    let totalCost = area * costPerSqFt;

    let html = `
    Area: ${area.toFixed(2)} sq ft<br>
    Units Required: ${units}<br>
    ${unitsPerBox ? `Boxes Required: ${boxes}<br>` : ``}
    Total Cost: Rs. ${totalCost.toFixed(2)}
    `;

    document.getElementById("manualOutput").innerHTML = html;
    saveHistory(html);
}

function calculateLayout(){

    let layoutUnit=document.getElementById("layoutUnitSelect").value;
    let roomLengthRaw=document.getElementById("roomLength").value;
    let roomWidthRaw=document.getElementById("roomWidth").value;

    let roomLength=convertToFeet(parseFloat(roomLengthRaw),layoutUnit);
    let roomWidth=convertToFeet(parseFloat(roomWidthRaw),layoutUnit);

    let tileUnit=document.getElementById("unitSelect").value;
    let tileLength=convertToFeet(parseFloat(document.getElementById("length").value),tileUnit);
    let tileWidth=convertToFeet(parseFloat(document.getElementById("width").value),tileUnit);

    if(!roomLength||!roomWidth||!tileLength||!tileWidth){
        alert("Enter all dimensions properly");
        return;
    }

    let areaMethod=Math.ceil((roomLength*roomWidth)/(tileLength*tileWidth));

    let A1=Math.ceil(roomLength/tileLength);
    let A2=Math.ceil(roomWidth/tileWidth);
    let totalA=A1*A2;

    let B1=Math.ceil(roomLength/tileWidth);
    let B2=Math.ceil(roomWidth/tileLength);
    let totalB=B1*B2;

    let best=Math.min(totalA,totalB);
    let recommended=Math.max(areaMethod,best);

    let html=
        `Room Size: ${roomLengthRaw} × ${roomWidthRaw} ${layoutUnit}<br><br>
         Area Method: ${areaMethod} units<br>
         Orientation A: ${A1} × ${A2} = ${totalA} units<br>
         Orientation B: ${B1} × ${B2} = ${totalB} units<br><br>
         Best Layout: ${best} units<br>
         Recommended Purchase: ${recommended} units`;

    document.getElementById("layoutOutput").innerHTML=html;
    saveHistory(html);
}

function saveHistory(data){
    let history;
    try{
        history=JSON.parse(localStorage.getItem("materialHistory"));
        if(!Array.isArray(history)) history=[];
    }catch{
        history=[];
    }
    history.unshift(data);
    localStorage.setItem("materialHistory",JSON.stringify(history));
    loadHistory();
}

function loadHistory(){
    let history;
    try{
        history=JSON.parse(localStorage.getItem("materialHistory"));
        if(!Array.isArray(history)) history=[];
    }catch{
        history=[];
    }

    let div=document.getElementById("history");
    div.innerHTML="";

    history.forEach((item,index)=>{
        let box=document.createElement("div");
        box.className="history-item";

        let content=document.createElement("div");
        content.className="history-content";
        content.innerHTML=item;

        let del=document.createElement("button");
        del.className="delete-btn";
        del.innerHTML="&times;";
        del.onclick=function(){deleteHistory(index);};

        box.appendChild(content);
        box.appendChild(del);
        div.appendChild(box);
    });
}

function deleteHistory(index){
    let history=JSON.parse(localStorage.getItem("materialHistory")||"[]");
    history.splice(index,1);
    localStorage.setItem("materialHistory",JSON.stringify(history));
    loadHistory();
}

function clearHistory(){
    localStorage.removeItem("materialHistory");
    loadHistory();
}

loadHistory();

</script>

</body>
</html>
